<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Tenis</title>
    <meta name="description" content="Tenis">
    <meta name="author" content="Dawid Gustowski">

    <link rel="icon" href="./icon-512.png">
    <link rel="apple-touch-icon" href="./icon-192.png">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-title" content="Dawid">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">

    <link rel="manifest" href="./manifest.json">
    <meta name="theme-color" content="#27ae60">

    <script src="./script.js"></script>
    <style>
        body {
            background-color: #27ae60;
            color: white;
            font-family: 'Segoe UI', sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
            overflow: hidden;
            touch-action: none;
        }

        #game-container {
            position: relative;
            background-color: #2ecc71;
            border: 5px solid white;
            box-shadow: 0 0 30px rgba(0,0,0,0.4);
        }

        canvas { display: block; }

        #ui-layer {
            position: absolute;
            top: 15px;
            width: 100%;
            display: flex;
            justify-content: space-between;
            padding: 0 25px;
            box-sizing: border-box;
            font-size: 20px;
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            pointer-events: none;
            z-index: 5;
        }

        .overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.85);
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            z-index: 10;
        }

        h2 { font-size: 36px; color: #f1c40f; margin: 0 0 20px 0; }
        .stat { font-size: 24px; margin: 10px; }

        button {
            margin-top: 25px;
            padding: 15px 40px;
            font-size: 20px;
            background: #e67e22;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
        }

        .hint {
            margin-top: 15px;
            font-size: 14px;
            color: #bdc3c7;
        }
    </style>
</head>
<body>

    <div id="game-container">
        <canvas id="tennisCanvas"></canvas>
        
        <div id="ui-layer">
            <div>‚ù§Ô∏è <span id="lives-val">3</span></div>
            <div>üèÜ <span id="score-val">0</span></div>
        </div>

        <div id="game-over" class="overlay">
            <h2>Koniec Gry!</h2>
            <div class="stat">Wynik: <span id="final-score" style="color: #fff">0</span></div>
            <div class="stat">Rekord: <span id="best-score" style="color: #f1c40f">0</span></div>
            <button onclick="resetGame()">Nowa Gra üîÑ</button>
        </div>
    </div>

    <div class="hint">PC: Strza≈Çki & Enter | Mobile: Dotknij boki ekranu</div>

<script>
    let dawid108 = localStorage.getItem("dawid108") || 0;
    const canvas = document.getElementById('tennisCanvas');
    const ctx = canvas.getContext('2d');
    
    const scoreVal = document.getElementById('score-val');
    const livesVal = document.getElementById('lives-val');
    const gameOverScreen = document.getElementById('game-over');
    const finalScoreEl = document.getElementById('final-score');
    const bestScoreEl = document.getElementById('best-score');

    function setupCanvas() {
        canvas.width = Math.min(window.innerWidth - 30, 400);
        canvas.height = Math.min(window.innerHeight - 180, 550);
    }
    setupCanvas();

    let score = 0;
    let lives = 3;
    let gameActive = false;
    let waitingForStart = true;

    // Paletki
    let playerWidth = 100;
    let computerWidth = 80;
    let playerX = (canvas.width - playerWidth) / 2;
    let computerX = (canvas.width - computerWidth) / 2;
    
    let computerSpeed = 5;
    let computerDir = 1;
    let playerSpeed = 5;

    // Sterowanie p≈Çynne
    let keys = { ArrowLeft: false, ArrowRight: false };
    let touches = { left: false, right: false };

    // Pi≈Çka
    let ballX, ballY, ballDX, ballDY;
    const ballEmoji = "ü•é";
    const playerEmoji = "‚ûñ";
    const computerEmoji = "‚ûñ";

    function initBall() {
        ballX = canvas.width / 2;
        ballY = canvas.height - 80;
        ballDX = (Math.random() - 0.5) * 6; // Wolniejszy start
        ballDY = -6; // Wolniejszy start
        waitingForStart = true;
        gameActive = true;
    }

    function draw() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);

        // Linia ≈õrodkowa
        ctx.strokeStyle = "rgba(255,255,255,0.2)";
        ctx.setLineDash([10, 15]);
        ctx.beginPath();
        ctx.moveTo(0, canvas.height/2);
        ctx.lineTo(canvas.width, canvas.height/2);
        ctx.stroke();

        // Rysowanie komputera (G√≥ra)
        ctx.font = `${computerWidth}px Arial`;
        ctx.textAlign = "center";
        ctx.textBaseline = "middle";
        ctx.fillText(computerEmoji, computerX + computerWidth/2, 50);

        // Rysowanie gracza (D√≥≈Ç)
        ctx.font = `${playerWidth}px Arial`;
        ctx.fillText(playerEmoji, playerX + playerWidth/2, canvas.height - 50);

        // Rysowanie pi≈Çki
        ctx.font = "26px Arial";
        ctx.fillText(ballEmoji, ballX, ballY);
    }

    function update() {
        if (waitingForStart || !gameActive) return;

        // P≈Çynny ruch gracza
        if (keys.ArrowLeft || touches.left) playerX -= playerSpeed;
        if (keys.ArrowRight || touches.right) playerX += playerSpeed;

        // Granice gracza
        if (playerX < 0) playerX = 0;
        if (playerX + playerWidth > canvas.width) playerX = canvas.width - playerWidth;

        // Ruch komputera (automatyczny od bandy do bandy)
        computerX += computerSpeed * computerDir;
        if (computerX + computerWidth > canvas.width || computerX < 0) {
            computerDir *= -1;
        }

        // Ruch pi≈Çki
        ballX += ballDX;
        ballY += ballDY;

        // Odbicia od ≈õcian bocznych
        if (ballX > canvas.width - 10 || ballX < 10) {
            ballDX *= -1;
        }

        // Kolizja z komputerem (G√≥ra)
        if (ballY < 80 && ballY > 40) {
            if (ballX > computerX && ballX < computerX + computerWidth) {
                ballDY = Math.abs(ballDY); // Odbij w d√≥≈Ç
                ballDX += (Math.random() - 0.5) * 4;
            }
        }

        // Kolizja z graczem (D√≥≈Ç)
        if (ballY > canvas.height - 80 && ballY < canvas.height - 40) {
            if (ballX > playerX && ballX < playerX + playerWidth) {
                ballDY = -Math.abs(ballDY); // Odbij w g√≥rƒô
                // Wp≈Çyw ruchu paletki na kƒÖt pi≈Çki
                let hitPoint = (ballX - (playerX + playerWidth/2)) / (playerWidth/2);
                ballDX = hitPoint * 4;
            }
        }

        // Punkt dla gracza
        if (ballY < 0) {
            score++;
            dawid108++;
            localStorage.setItem("dawid108", dawid108);
            console.log("dawid108:", dawid108);
            scoreVal.innerText = score;
            computerWidth = Math.min(100, computerWidth + 3);
            computerSpeed += 0.1;
            initBall();
        }

        // Strata ≈ºycia
        if (ballY > canvas.height) {
            lives--;
            livesVal.innerText = lives;
            if (lives <= 0) endGame();
            else initBall();
        }
    }

    function gameLoop() {
        draw();
        update();
        requestAnimationFrame(gameLoop);
    }

    // Obs≈Çuga Klawiatury
    document.addEventListener('keydown', (e) => {
        if (e.key in keys) keys[e.key] = true;
        if (e.key === "Enter" && waitingForStart) waitingForStart = false;
    });
    document.addEventListener('keyup', (e) => {
        if (e.key in keys) keys[e.key] = false;
    });

    // Obs≈Çuga Dotyku
    canvas.addEventListener('touchstart', (e) => {
        e.preventDefault();
        const touchX = e.touches[0].clientX - canvas.getBoundingClientRect().left;
        
        if (waitingForStart) {
            waitingForStart = false;
        } else {
            if (touchX < canvas.width / 2) touches.left = true;
            else touches.right = true;
        }
    }, {passive: false});

    canvas.addEventListener('touchend', (e) => {
        touches.left = false;
        touches.right = false;
    });

    function endGame() {
        gameActive = false;
        const record = localStorage.getItem('tenis') || 0;
        if (score > record) localStorage.setItem('tenis', score);
        
        finalScoreEl.innerText = score;
        bestScoreEl.innerText = Math.max(score, record);
        gameOverScreen.style.display = 'flex';
    }

    function resetGame() {
        score = 0;
        lives = 3;
        computerWidth = 80;
        computerSpeed = 5;
        scoreVal.innerText = score;
        livesVal.innerText = lives;
        gameOverScreen.style.display = 'none';
        initBall();
    }

    initBall();
    gameLoop();

</script>
</body>
</html>
