<!doctype html>
<html lang="pl">
<head>    
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Flagi</title>
    <meta name="description" content="Flagi">
    <meta name="author" content="Dawid Gustowski">

    <link rel="icon" href="./icon-512.png">
    <link rel="apple-touch-icon" href="./icon-192.png">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-title" content="Dawid">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">

    <link rel="manifest" href="./manifest.json">
    <meta name="theme-color" content="#071024">

    <script src="./script.js"></script>
  <style>
    :root{
      --bg:#0f1724; --card:#0b1220; --accent:#7c5cff; --muted:#94a3b8; --glass: rgba(255,255,255,0.04);
      --glass-2: rgba(255,255,255,0.03);
      --radius:16px;
      --safe-padding:16px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; font-family:Inter, ui-sans-serif, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
      background: radial-gradient(1200px 600px at 10% 10%, rgba(124,92,255,0.12), transparent),
                  linear-gradient(180deg, var(--bg), #071024 140%);
      color:#e6eef8; -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
      display:flex; align-items:center; justify-content:center; padding:24px;
    }

    .app{
      width:100%; max-width:840px; background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border-radius:20px; padding:20px; box-shadow: 0 8px 30px rgba(2,6,23,0.7);
      border: 1px solid rgba(255,255,255,0.03);
    }

    header{
      display:flex; justify-content:space-between; align-items:center; gap:12px; margin-bottom:18px;
    }
    .top-left, .top-right{
      display:flex; gap:8px; align-items:center;
      background:var(--glass); padding:8px 12px; border-radius:12px; font-weight:600; color:var(--muted);
    }
    .top-left .time, .top-right .score{font-size:1.05rem; color:#fff}

    main{
      display:flex; flex-direction:column; align-items:center; gap:12px; padding:16px;
    }

    .reveal{
      min-height:22px; color:var(--muted); font-weight:600; text-align:center; margin-bottom:6px; opacity:0.95;
    }

    .emoji-card{
      width:min(62vw,420px); aspect-ratio:1/1; display:flex; align-items:center; justify-content:center;
      background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); border-radius:16px; border:1px solid var(--glass-2);
      box-shadow: inset 0 -8px 30px rgba(2,6,23,0.35), 0 8px 40px rgba(2,6,23,0.6);
      font-size:6.6rem; user-select:none; -webkit-user-select:none; position:relative;
      transition:transform .12s ease;
    }
    .emoji-card.small{font-size:5rem}

    input[type="text"]{
      width:100%; max-width:540px; padding:12px 14px; border-radius:12px; border:1px solid rgba(255,255,255,0.04);
      background:rgba(255,255,255,0.02); color:#fff; font-size:1.05rem; outline:none; text-align:center;
    }
    input[type="text"]:disabled{opacity:0.5}

    .controls{display:flex; gap:10px; align-items:center; margin-top:8px}
    button{cursor:pointer; border:0; padding:10px 14px; border-radius:10px; font-weight:700}
    .btn-start{background:linear-gradient(90deg,var(--accent), #6bd3ff); color:#021025; box-shadow:0 6px 20px rgba(124,92,255,0.18)}
    .btn-small{background:transparent; color:var(--muted); border:1px solid rgba(255,255,255,0.03)}

    /* result modal */
    .overlay{position:fixed; inset:0; display:none; align-items:center; justify-content:center; z-index:50}
    .overlay.show{display:flex}
    .modal{background:linear-gradient(180deg, rgba(10,14,22,0.9), rgba(8,10,16,0.95)); padding:24px; border-radius:14px; width:min(92%,420px); text-align:center; border:1px solid rgba(255,255,255,0.04)}
    .modal h2{margin:6px 0 2px; font-size:1.6rem}
    .modal p{margin:0 0 12px; color:var(--muted)}

    footer{display:flex; justify-content:center; margin-top:12px}

    @media(min-width:900px){
      body{padding:40px}
      .app{padding:28px}
    }

    /* small helpers */
    .muted{color:var(--muted)}
  </style>
</head>
<body>
  <div class="app" role="application">
    <header>
      <div class="top-left"><div class="muted">Czas:</div>&nbsp;<div class="time">60s</div></div>
      <div class="top-right"><div class="muted">Punkty:</div>&nbsp;<div class="score">0</div></div>
    </header>

    <main>
      <div class="reveal" id="revealText"></div>
      <div class="emoji-card" id="emojiCard" aria-live="polite">‚ùì</div>

      <input id="guessInput" type="text" placeholder="Wpisz nazwƒô emotki (PL / EN)" autocomplete="off" inputmode="text" spellcheck="false"  autocorrect="off" />

      <div class="controls">
        <button id="startBtn" class="btn-start">Rozpocznij Grƒô</button>
        <button id="hintBtn" class="btn-small">Poka≈º podpowied≈∫</button>
      </div>

      <footer class="muted" style="margin-top:8px">Zgadnij emotkƒô ‚Äî mo≈ºesz wpisywaƒá po polsku lub po angielsku. B≈Çƒôdna odpowied≈∫: -1s.</footer>
    </main>
  </div>

  <div class="overlay" id="overlay">
    <div class="modal" role="dialog" aria-modal="true">
      <h2>Tw√≥j Wynik</h2>
      <p id="finalScore">0</p>
      <h3>Tw√≥j Rekord</h3>
      <p id="bestScore">0</p>
      <div style="margin-top:12px">
        <button id="restartBtn" class="btn-start">Nowa gra</button>
      </div>
    </div>
  </div>

  <script>
    // --- Dane emotek ---
    // Ka≈ºdy obiekt ma pola: emoji, pl (g≈Ç√≥wna polska), en (g≈Ç√≥wna angielska), others (tablica dodatkowych poprawnych s≈Ç√≥w)
    const EMOJI_BANK = {
     easy: [
  {emoji:'üá¶üá∑', pl:'Argentyna', en:'Argentina', others:['Buenos Aires','argentinian','argantina']},
  {emoji:'üáßüá∑', pl:'Brazylia', en:'Brazil', others:['Bras√≠lia','brazilian','brasil']},
  {emoji:'üá©üá™', pl:'Niemcy', en:'Germany', others:['Berlin','german','germanny']},
  {emoji:'üá™üá∏', pl:'Hiszpania', en:'Spain', others:['Madryt','spanish','spainnn']},
  {emoji:'üá´üá∑', pl:'Francja', en:'France', others:['Pary≈º','french','frnace']},
  {emoji:'üáÆüáπ', pl:'W≈Çochy', en:'Italy', others:['Rzym','italian','italia']},
  {emoji:'üáµüá±', pl:'Polska', en:'Poland', others:['Warszawa','polish','polen']},
  {emoji:'üáµüáπ', pl:'Portugalia', en:'Portugal', others:['Lizbona','portuguese','portagal']},
  {emoji:'üá≠üá∑', pl:'Chorwacja', en:'Croatia', others:['Zagrzeb','croatian','chrovacia']},
  {emoji:'üá∫üá∏', pl:'Stany Zjednoczone', en:'United States', others:['Waszyngton','american','usa', 'stany']}
     ],
     medium:[
  {emoji:'üá¶üá©', pl:'Andora', en:'Andorra', others:['Andora la Vella','andorran','andora']},
  {emoji:'üá¶üá™', pl:'Zjednoczone Emiraty Arabskie', en:'United Arab Emirates', others:['Abu Zabi','emirati','emirats', 'zea', 'emiraty']},
  {emoji:'üá¶üá´', pl:'Afganistan', en:'Afghanistan', others:['Kabul','afghan','afganistan']},
  {emoji:'üá¶üá±', pl:'Albania', en:'Albania', others:['Tirana','albanian','albanie']},
  {emoji:'üá¶üá∂', pl:'Antarktyda', en:'Antarctica', others:['McMurdo','antarctic','antartica']},
  {emoji:'üá¶üá¨', pl:'Antigua i Barbuda', en:'Antigua and Barbuda', others:['Saint John‚Äôs','antiguan','antigua', 'aib', 'barbuda']},
  {emoji:'üá¶üá≤', pl:'Armenia', en:'Armenia', others:['Erywa≈Ñ','armenian','armenja']},
  {emoji:'üá¶üá¥', pl:'Angola', en:'Angola', others:['Luanda','angolan','angoola']},
  {emoji:'üá¶üáπ', pl:'Austria', en:'Austria', others:['Wiede≈Ñ','austrian','austrija']},
  {emoji:'üá¶üá∫', pl:'Australia', en:'Australia', others:['Canberra','australian','austrailia']},
  {emoji:'üá¶üáø', pl:'Azerbejd≈ºan', en:'Azerbaijan', others:['Baku','azerbaijani','azerbajan']},
  {emoji:'üáßüá¶', pl:'Bo≈õnia i Hercegowina', en:'Bosnia and Herzegovina', others:['Sarajewo','bosnian','bosnia', 'bih']},
  {emoji:'üáßüáß', pl:'Barbados', en:'Barbados', others:['Bridgetown','barbadian','barbadoss']},
  {emoji:'üáßüá©', pl:'Bangladesz', en:'Bangladesh', others:['Dhaka','bangladeshi','bangladeshh']},
  {emoji:'üáßüá™', pl:'Belgia', en:'Belgium', others:['Bruksela','belgian','belgiam']},
  {emoji:'üáßüá´', pl:'Burkina Faso', en:'Burkina Faso', others:['Wagadugu','burkinabe','burkinafaso', 'burkina']},
  {emoji:'üáßüá¨', pl:'Bu≈Çgaria', en:'Bulgaria', others:['Sofia','bulgarian','bulgaira']},
  {emoji:'üáßüá≠', pl:'Bahrajn', en:'Bahrain', others:['Manama','bahraini','bahrein']},
  {emoji:'üáßüáØ', pl:'Benin', en:'Benin', others:['Porto-Novo','beninese','benine']},
  {emoji:'üáßüá≤', pl:'Bermudy', en:'Bermuda', others:['Hamilton','bermudian','bermooda']},
  {emoji:'üáßüá¥', pl:'Boliwia', en:'Bolivia', others:['Sucre','bolivian','bolvia']},
  {emoji:'üáßüá∏', pl:'Bahamy', en:'Bahamas', others:['Nassau','bahamian','bahams']},
  {emoji:'üáßüáº', pl:'Botswana', en:'Botswana', others:['Gaborone','botswanan','botswna', 'bostwana']},
  {emoji:'üáßüáæ', pl:'Bia≈Çoru≈õ', en:'Belarus', others:['Mi≈Ñsk','belarusian','belaruse']},
  {emoji:'üá®üá¶', pl:'Kanada', en:'Canada', others:['Ottawa','canadian','canadaa']},
  {emoji:'üá®üá®', pl:'Wyspy Kokosowe', en:'Cocos (Keeling) Islands', others:['West Island','cocos','coccos', 'wk', 'kokos']},
  {emoji:'üá®üá©', pl:'Demokratyczna Republika Konga', en:'Democratic Republic of the Congo', others:['Kinszasa','congolese','drc', 'drk', 'kongo']},
  {emoji:'üá®üá´', pl:'Republika ≈örodkowoafryka≈Ñska', en:'Central African Republic', others:['Bangui','central african','car', 'rs', 'rsa', 'srodek']},
  {emoji:'üá®üá¨', pl:'Kongo', en:'Congo', others:['Brazaville','congolese','kongo']},
  {emoji:'üá®üá≠', pl:'Szwajcaria', en:'Switzerland', others:['Berno','swiss','switserland']},
  {emoji:'üá®üáÆ', pl:'Wybrze≈ºe Ko≈õci S≈Çoniowej', en:'Ivory Coast', others:['Jamestown','ivorian','ivry coast', 'wks', 'kosci', 'slon']},
  {emoji:'üá®üá±', pl:'Chile', en:'Chile', others:['Santiago','chilean','chilli']},
  {emoji:'üá®üá≤', pl:'Kamerun', en:'Cameroon', others:['Jaunde','cameroonian','kamerun']},
  {emoji:'üá®üá≥', pl:'Chiny', en:'China', others:['Pekin','chinese','chinna']},
  {emoji:'üá®üá¥', pl:'Kolumbia', en:'Colombia', others:['Bogota','colombian','columbia']},
  {emoji:'üá®üá∑', pl:'Kostaryka', en:'Costa Rica', others:['San Jose','costa rican','costarica']},
  {emoji:'üá®üá∫', pl:'Kuba', en:'Cuba', others:['Hawana','cuban','kubaa']},
  {emoji:'üá®üáª', pl:'Republika Zielonego PrzylƒÖdka', en:'Cape Verde', others:['Praia','cape verdean','capeverd', 'rzp', 'zielony', 'przyladek']},
  {emoji:'üá®üáº', pl:'Cura√ßao', en:'Cura√ßao', others:['Willemstad','curacaoan','curacoa', 'curacao']},
  {emoji:'üá®üáΩ', pl:'Wyspa Bo≈ºego Narodzenia', en:'Christmas Island', others:['Flying Fish Cove','christmas','xmas island', 'wbn']},
  {emoji:'üá®üáæ', pl:'Cypr', en:'Cyprus', others:['Nikozja','cypriot','cypruss']},
  {emoji:'üá®üáø', pl:'Czechy', en:'Czech Republic', others:['Praga','czech','chech']},
  {emoji:'üá©üáØ', pl:'D≈ºibuti', en:'Djibouti', others:['D≈ºibuti','djiboutian','jibuti', 'd≈ºibutti']},
  {emoji:'üá©üá∞', pl:'Dania', en:'Denmark', others:['Kopenhaga','danish','denmak']},
  {emoji:'üá©üá≤', pl:'Dominika', en:'Dominica', others:['Roseau','dominican','dominika']},
  {emoji:'üá©üá¥', pl:'Dominikana', en:'Dominican Republic', others:['Santo Domingo','dominican','dominicana']},
  {emoji:'üá©üáø', pl:'Algieria', en:'Algeria', others:['Algier','algerian','algerie']},
  {emoji:'üá™üá®', pl:'Ekwador', en:'Ecuador', others:['Quito','ecuadorian','equador']},
  {emoji:'üá™üá™', pl:'Estonia', en:'Estonia', others:['Tallinn','estonian','estonie']},
  {emoji:'üá™üá¨', pl:'Egipt', en:'Egypt', others:['Kair','egyptian','egipt']},
  {emoji:'üá™üá≠', pl:'Sahara Zachodnia', en:'Western Sahara', others:['Laayoune','sahrawi','west sahara', 'sahara']},
  {emoji:'üá™üáπ', pl:'Etiopia', en:'Ethiopia', others:['Addis Abeba','ethiopian','etiopa']},
  {emoji:'üá´üáÆ', pl:'Finlandia', en:'Finland', others:['Helsinki','finnish','finlandd']},
  {emoji:'üá´üáØ', pl:'Fid≈ºi', en:'Fiji', others:['Suva','fijian','fijji']},
  {emoji:'üá´üá¥', pl:'Wyspy Owcze', en:'Faroe Islands', others:['T√≥rshavn','faroese','faro islands', 'owce']},
  {emoji:'üá¨üá¶', pl:'Gabon', en:'Gabon', others:['Libreville','gabonese','gabbon']},
  {emoji:'üá¨üáß', pl:'Wielka Brytania', en:'United Kingdom', others:['Londyn','british','uk','england','great britain']},
  {emoji:'üá¨üá©', pl:'Grenada', en:'Grenada', others:['Saint George‚Äôs','grenadian','greneda', 'granada']},
  {emoji:'üá¨üá™', pl:'Gruzja', en:'Georgia', others:['Tbilisi','georgian','gruzia']},
  {emoji:'üá¨üá´', pl:'Gujana Francuska', en:'French Guiana', others:['Kajenna','french guiana','gujana francuska', 'francja', 'gujana']},
  {emoji:'üá¨üá≠', pl:'Ghana', en:'Ghana', others:['Akra','ghanaian','gana']},
  {emoji:'üá¨üáÆ', pl:'Gibraltar', en:'Gibraltar', others:['gibraltarian','gibralter', 'giblartar']},
  {emoji:'üá¨üá±', pl:'Grenlandia', en:'Greenland', others:['Nuuk','greenlander','greenlnd']},
  {emoji:'üá¨üá≤', pl:'Gambia', en:'Gambia', others:['Band≈ºul','gambian','gambiaa']},
  {emoji:'üá¨üá≥', pl:'Gwinea', en:'Guinea', others:['Konakry','guinean','guiena']},
  {emoji:'üá¨üáµ', pl:'Gwadelupa', en:'Guadeloupe', others:['Basse-Terre','guadeloupian','guadelupe', 'gwandelupa', 'guadelupa']},
  {emoji:'üá¨üá∂', pl:'Gwinea R√≥wnikowa', en:'Equatorial Guinea', others:['Malabo','equatoguinean','guinea equatorial', 'gwinea', 'rownik']},
  {emoji:'üá¨üá∑', pl:'Grecja', en:'Greece', others:['Ateny','greek','grecee']},
  {emoji:'üá¨üáπ', pl:'Gwatemala', en:'Guatemala', others:['Gwatemala City','guatemalan','guatamala']},
  {emoji:'üá¨üáæ', pl:'Gujana', en:'Guyana', others:['Georgetown','guyanese','guyanna']},
  {emoji:'üá≠üá∞', pl:'Hongkong', en:'Hong Kong', others:['hongkong','hongkong sar','hk']},
  {emoji:'üá≠üá≤', pl:'Wyspy Heard i McDonalda', en:'Heard Island and McDonald Islands', others:['heard island','mcdonald islands', 'mcdonald', 'mcdonalds', 'donald', 'heard', 'australia']},
  {emoji:'üá≠üá≥', pl:'Honduras', en:'Honduras', others:['Tegucigalpa','honduran','hondorus']},
  {emoji:'üá≠üáπ', pl:'Haiti', en:'Haiti', others:['Port-au-Prince','haitian','haitii']},
  {emoji:'üá≠üá∫', pl:'Wƒôgry', en:'Hungary', others:['Budapeszt','hungarian','hungaryy']},
  {emoji:'üáÆüá®', pl:'Wyspy Kanaryjskie', en:'Canary Islands', others:['Las Palmas','canaries','islas canarias', 'kanary', 'canary']},
  {emoji:'üáÆüá©', pl:'Indonezja', en:'Indonesia', others:['D≈ºakarta','indonesian','indonasia', 'monaco', 'monako']},
  {emoji:'üáÆüá™', pl:'Irlandia', en:'Ireland', others:['Dublin','irish','irelnd']},
  {emoji:'üáÆüá±', pl:'Izrael', en:'Israel', others:['Jerozolima','israeli','isreal']},
  {emoji:'üáÆüá≥', pl:'Indie', en:'India', others:['Nowe Delhi','indian','indiaa']},
  {emoji:'üáÆüá∂', pl:'Irak', en:'Iraq', others:['Bagdad','iraqi','irack']},
  {emoji:'üáÆüá∑', pl:'Iran', en:'Iran', others:['Teheran','iranian','irn']},
  {emoji:'üáÆüá∏', pl:'Islandia', en:'Iceland', others:['Reykjavik','icelander','icelandic']},
  {emoji:'üáØüá≤', pl:'Jamajka', en:'Jamaica', others:['Kingston','jamaican','jamayka']},
  {emoji:'üáØüá¥', pl:'Jordania', en:'Jordan', others:['Amman','jordanian','jordann']},
  {emoji:'üáØüáµ', pl:'Japonia', en:'Japan', others:['Tokio','japanese','japanse']},
  {emoji:'üá∞üá™', pl:'Kenia', en:'Kenya', others:['Nairobi','kenyan','kenyya']},
  {emoji:'üá∞üá¨', pl:'Kirgistan', en:'Kyrgyzstan', others:['Biszkek','kyrgyz','kirgizstan']},
  {emoji:'üá∞üá≠', pl:'Kambod≈ºa', en:'Cambodia', others:['Phnom Penh','cambodian','cambodza']},
  {emoji:'üá∞üá≤', pl:'Komory', en:'Comoros', others:['Moroni','comorian','komoros']},
  {emoji:'üá∞üá≥', pl:'Saint Kitts i Nevis', en:'Saint Kitts and Nevis', others:['Basseterre','kitts','nevis', 'kit', 'skin', 'skn']},
  {emoji:'üá∞üáµ', pl:'Korea P√≥≈Çnocna', en:'North Korea', others:['Pjongjang','north korean','dprk', 'korea']},
  {emoji:'üá∞üá∑', pl:'Korea Po≈Çudniowa', en:'South Korea', others:['Seul','south korean','rok', 'korea']},
  {emoji:'üá∞üáº', pl:'Kuwejt', en:'Kuwait', others:['Kuwejt City','kuwaiti','kuweit']},
  {emoji:'üá∞üáø', pl:'Kazachstan', en:'Kazakhstan', others:['Astana','kazakh','kazakstan']},
  {emoji:'üá±üá¶', pl:'Laos', en:'Laos', others:['Wientian','laotian','laoss']},
  {emoji:'üá±üáß', pl:'Liban', en:'Lebanon', others:['Bejrut','lebanese','lebannon']},
  {emoji:'üá±üáÆ', pl:'Liechtenstein', en:'Liechtenstein', others:['Vaduz','liechtensteiner','lichtenstein']},
  {emoji:'üá±üá∞', pl:'Sri Lanka', en:'Sri Lanka', others:['Sri D≈∫ajawardanapura Kotte','sri lankan','ceylon', 'sri', 'lanka']},
  {emoji:'üá±üá∑', pl:'Liberia', en:'Liberia', others:['Monrovia','liberian','liberya']},
  {emoji:'üá±üá∏', pl:'Lesotho', en:'Lesotho', others:['Maseru','basotho','lesoto']},
  {emoji:'üá±üáπ', pl:'Litwa', en:'Lithuania', others:['Wilno','lithuanian','litwa']},
  {emoji:'üá±üá∫', pl:'Luksemburg', en:'Luxembourg', others:['Luksemburg','luxembourgish','luxemburg']},
  {emoji:'üá±üáª', pl:'≈Åotwa', en:'Latvia', others:['Ryga','latvian','lotva']},
  {emoji:'üá±üáæ', pl:'Libia', en:'Libya', others:['Trypolis','libyan','libyia']},
  {emoji:'üá≤üá¶', pl:'Maroko', en:'Morocco', others:['Rabat','moroccan','marocco']},
  {emoji:'üá≤üá®', pl:'Monako', en:'Monaco', others:['Monako','monacan','monnaco', 'indonezja', 'indonesia']},
  {emoji:'üá≤üá©', pl:'Mo≈Çdawia', en:'Moldova', others:['Kiszyni√≥w','moldovan','moldavia']},
  {emoji:'üá≤üá™', pl:'Czarnog√≥ra', en:'Montenegro', others:['Podgorica','montenegrin','montenegoro']},
  {emoji:'üá≤üá´', pl:'Saint-Martin', en:'Saint Martin', others:['Marigot','st martin','saintmartin', 'francja', 'france']},
  {emoji:'üá≤üá¨', pl:'Madagaskar', en:'Madagascar', others:['Antananarywa','malagasy','madagazcar']},
  {emoji:'üá≤üá≠', pl:'Wyspy Marshalla', en:'Marshall Islands', others:['Majuro','marshallese','marshall island', 'marszal']},
  {emoji:'üá≤üá∞', pl:'Macedonia P√≥≈Çnocna', en:'North Macedonia', others:['Skopje','macedonian','fyrom', 'macedonia']},
  {emoji:'üá≤üá±', pl:'Mali', en:'Mali', others:['Bamako','malian','malii']},
  {emoji:'üá≤üá≥', pl:'Mongolia', en:'Mongolia', others:['U≈Çan Bator','mongolian','mongolya']},
  {emoji:'üá≤üá¥', pl:'Makau', en:'Macau', others:['makau','macao','macau sar']},
  {emoji:'üá≤üá∂', pl:'Martynika', en:'Martinique', others:['Fort-de-France','martiniquais','martinika']},
  {emoji:'üá≤üá∑', pl:'Mauretania', en:'Mauritania', others:['Nawakszut','mauritanian','mauritaniaa']},
  {emoji:'üá≤üá∏', pl:'Montserrat', en:'Montserrat', others:['Plymouth','montserratian','monserat']},
  {emoji:'üá≤üáπ', pl:'Malta', en:'Malta', others:['Valletta','maltese','maltaa']},
  {emoji:'üá≤üá∫', pl:'Mauritius', en:'Mauritius', others:['Port Louis','mauritian','mauritiuss']},
  {emoji:'üá≤üáª', pl:'Malediwy', en:'Maldives', others:['Male','maldivian','maledives']},
  {emoji:'üá≤üáº', pl:'Malawi', en:'Malawi', others:['Lilongwe','malawian','malawiie']},
  {emoji:'üá≤üáΩ', pl:'Meksyk', en:'Mexico', others:['Meksyk City','mexican','mexiko']},
  {emoji:'üá≤üáæ', pl:'Malezja', en:'Malaysia', others:['Kuala Lumpur','malaysian','malezia']},
  {emoji:'üá≤üáø', pl:'Mozambik', en:'Mozambique', others:['Maputo','mozambican','mozambiquee']},
  {emoji:'üá≥üá¶', pl:'Namibia', en:'Namibia', others:['Windhuk','namibian','namibya']},
  {emoji:'üá≥üá™', pl:'Niger', en:'Niger', others:['Niamey','nigerien','nigger']},
  {emoji:'üá≥üá¨', pl:'Nigeria', en:'Nigeria', others:['Abud≈ºa','nigerian','nigeriaa']},
  {emoji:'üá≥üáÆ', pl:'Nikaragua', en:'Nicaragua', others:['Managua','nicaraguan','nikaraguaa', 'salwador']},
  {emoji:'üá≥üá±', pl:'Holandia', en:'Netherlands', others:['Amsterdam','dutch','holland', 'niderland', 'niderlandia', 'niderlandy']},
  {emoji:'üá≥üá¥', pl:'Norwegia', en:'Norway', others:['Oslo','norwegian','norwey']},
  {emoji:'üá≥üáµ', pl:'Nepal', en:'Nepal', others:['Katmandu','nepali','neepal', 'everest']},
  {emoji:'üá≥üáø', pl:'Nowa Zelandia', en:'New Zealand', others:['Wellington','kiwi','aotearoa', 'zelandia']},
  {emoji:'üá¥üá≤', pl:'Oman', en:'Oman', others:['Maskat','omani','omann']},
  {emoji:'üáµüá¶', pl:'Panama', en:'Panama', others:['Panama City','panamanian','panamaa']},
  {emoji:'üáµüá™', pl:'Peru', en:'Peru', others:['Lima','peruvian','peruu']},
  {emoji:'üáµüá¨', pl:'Papua-Nowa Gwinea', en:'Papua New Guinea', others:['Port Moresby','papuan','png', 'gwinea', 'paupa']},
  {emoji:'üáµüá≠', pl:'Filipiny', en:'Philippines', others:['Manila','filipino','phillipines']},
  {emoji:'üáµüá∞', pl:'Pakistan', en:'Pakistan', others:['Islamabad','pakistani','pakistaan']},
  {emoji:'üáµüá∑', pl:'Portoryko', en:'Puerto Rico', others:['San Juan','puertorican','porto rico']},
  {emoji:'üáµüá∏', pl:'Palestyna', en:'Palestine', others:['Ramallah','palestinian','palastine']},
  {emoji:'üáµüáæ', pl:'Paragwaj', en:'Paraguay', others:['Asunci√≥n','paraguayan','paragway']},
  {emoji:'üá∂üá¶', pl:'Katar', en:'Qatar', others:['Doha','qatari','quatar']},
  {emoji:'üá∑üá™', pl:'Reunion', en:'R√©union', others:['Saint-Denis','reunionese','reunion island', 'francja', 'renion']},
  {emoji:'üá∑üá¥', pl:'Rumunia', en:'Romania', others:['Bukareszt','czad','chad']},
  {emoji:'üá∑üá∏', pl:'Serbia', en:'Serbia', others:['Belgrad','serbian','serbiaa']},
  {emoji:'üá∑üá∫', pl:'Rosja', en:'Russia', others:['Moskwa','russian','rossiya']},
  {emoji:'üá∑üáº', pl:'Rwanda', en:'Rwanda', others:['Kigali','rwandan','ruanda']},
  {emoji:'üá∏üá¶', pl:'Arabia Saudyjska', en:'Saudi Arabia', others:['Rijad','saudi','ksa', 'arabia']},
  {emoji:'üá∏üáß', pl:'Wyspy Salomona', en:'Solomon Islands', others:['Honiara','solomon islander','salomon', 'salamon']},
  {emoji:'üá∏üá®', pl:'Seszele', en:'Seychelles', others:['Victoria','seychellois','seycheles']},
  {emoji:'üá∏üá©', pl:'Sudan', en:'Sudan', others:['Chartum','sudanese','sudann']},
  {emoji:'üá∏üá™', pl:'Szwecja', en:'Sweden', others:['Sztokholm','swedish','swedden']},
  {emoji:'üá∏üá¨', pl:'Singapur', en:'Singapore', others:['singaporean','Singapur','singapour']},
  {emoji:'üá∏üáÆ', pl:'S≈Çowenia', en:'Slovenia', others:['Lublana','slovenian','slovenija']},
  {emoji:'üá∏üá∞', pl:'S≈Çowacja', en:'Slovakia', others:['Bratys≈Çawa','slovak','slovakya']},
  {emoji:'üá∏üá±', pl:'Sierra Leone', en:'Sierra Leone', others:['Freetown','sierra leonian','serra leone', 'leon', 'leone']},
  {emoji:'üá∏üá≤', pl:'San Marino', en:'San Marino', others:['San Marino','sammarinese','sanmarino', 'san']},
  {emoji:'üá∏üá≥', pl:'Senegal', en:'Senegal', others:['Dakar','senegalese','senegall']},
  {emoji:'üá∏üá¥', pl:'Somalia', en:'Somalia', others:['Mogadiszu','somali','somaliya']},
  {emoji:'üá∏üá∑', pl:'Surinam', en:'Suriname', others:['Paramaribo','surinamese','surinamee']},
  {emoji:'üá∏üá∏', pl:'Sudan Po≈Çudniowy', en:'South Sudan', others:['D≈ºuba','south sudanese','southern sudan', 'sudan']},
  {emoji:'üá∏üáπ', pl:'Wyspy ≈öwiƒôtego Tomasza i KsiƒÖ≈ºƒôca', en:'S√£o Tom√© and Pr√≠ncipe', others:['S√£o Tom√©','sao tome','principe', 'wstik', 'tomasz', 'ksiaze']},
  {emoji:'üá∏üáª', pl:'Salwador', en:'El Salvador', others:['San Salvador','salvadoran','elsalvador', 'nikaragua', 'salvador']},
  {emoji:'üá∏üáæ', pl:'Syria', en:'Syria', others:['Damaszek','syrian','syriya']},
  {emoji:'üáπüá©', pl:'Czad', en:'Chad', others:['Nd≈ºamena','czad','rumunia']}, // podobna flaga do Rumunii
  {emoji:'üáπüá¨', pl:'Togo', en:'Togo', others:['Lome','togolese','togoo']},
  {emoji:'üáπüá≠', pl:'Tajlandia', en:'Thailand', others:['Bangkok','thai','thailande']},
  {emoji:'üáπüáØ', pl:'Tad≈ºykistan', en:'Tajikistan', others:['Duszanbe','tajik','tadjikistan']},
  {emoji:'üáπüá≤', pl:'Turkmenistan', en:'Turkmenistan', others:['Aszchabad','turkmen','turkmanistan']},
  {emoji:'üáπüá≥', pl:'Tunezja', en:'Tunisia', others:['Tunis','tunisian','tunizja']},
  {emoji:'üáπüá¥', pl:'Tonga', en:'Tonga', others:['Nuku ªalofa','tongan','tonga island']},
  {emoji:'üáπüá∑', pl:'Turcja', en:'Turkey', others:['Ankara','turkish','turkiye']},
  {emoji:'üáπüáπ', pl:'Trynidad i Tobago', en:'Trinidad and Tobago', others:['Port of Spain','trinidadian','trinidad tobago', 'trinidad', 'tobago', 'tit']},
  {emoji:'üáπüáº', pl:'Tajwan', en:'Taiwan', others:['Tajpej','taiwanese','republic of china']},
  {emoji:'üáπüáø', pl:'Tanzania', en:'Tanzania', others:['Dodoma','tanzanian','tanzanya']},
  {emoji:'üá∫üá¶', pl:'Ukraina', en:'Ukraine', others:['Kij√≥w','ukrainian','ukraina']},
  {emoji:'üá∫üá¨', pl:'Uganda', en:'Uganda', others:['Kampala','ugandan','ugandaa']},
  {emoji:'üá∫üá≤', pl:'Dalekie Wyspy Mniejsze Stan√≥w Zjednoczonych', en:'United States Minor Outlying Islands', others:['johnston atoll','usmo','palmyra', 'usa', 'stany zjednoczone', 'united states']},
  {emoji:'üá∫üáæ', pl:'Urugwaj', en:'Uruguay', others:['Montevideo','uruguayan','urugway']},
  {emoji:'üá∫üáø', pl:'Uzbekistan', en:'Uzbekistan', others:['Taszkent','uzbek','uzbekystan']},
  {emoji:'üáªüá¶', pl:'Watykan', en:'Vatican City', others:['Vatican','holy see','vatikan']},
  {emoji:'üáªüá®', pl:'Saint Vincent i Grenadyny', en:'Saint Vincent and the Grenadines', others:['Kingstown','st vincent','grenadines', 'vincent', 'wincent', 'grenadyny']},
  {emoji:'üáªüá™', pl:'Wenezuela', en:'Venezuela', others:['Caracas','venezuelan','venezuella']},
  {emoji:'üáªüá≥', pl:'Wietnam', en:'Vietnam', others:['Hanoi','vietnamese','viet nam']},
  {emoji:'üáΩüá∞', pl:'Kosowo', en:'Kosovo', others:['Prisztina','kosovar','kosova']},
  {emoji:'üáæüá™', pl:'Jemen', en:'Yemen', others:['Sana','yemeni','yaman']},
  {emoji:'üáøüá¶', pl:'Republika Po≈Çudniowej Afryki', en:'South Africa', others:['Pretoria','south african','rpa', 'rap']},
  {emoji:'üáøüá≤', pl:'Zambia', en:'Zambia', others:['Lusaka','zambian','zambiya']},
  {emoji:'üá∏üáØ', pl:'Svalbard i Jan Mayen', en:'Svalbard and Jan Mayen', others:['Longyearbyen','jan mayen','svalbard', 'jan', 'norwegia', 'norway']},
  {emoji:'üá™üá¶', pl:'Ceuta i Melilla', en:'Ceuta and Melilla', others:['Ceuta','melilla','ceuta melila', 'hiszpania', 'spain']},
  {emoji:'üáßüáª', pl:'Wyspa Bouveta', en:'Bouvet Island', others:['bouvet','bovet', 'bouveta', 'boveta', 'wyspa', 'norwegia', 'norway']},
  {emoji:'üá®üáµ', pl:'Clipperton', en:'Clipperton Island', others:['clipperton','clippperton', 'france', 'francja']},
  {emoji:'üè¥Û†ÅßÛ†Å¢Û†Å•Û†ÅÆÛ†ÅßÛ†Åø', pl:'Anglia', en:'England', others:['Londyn','english','kane']},
  {emoji:'üè¥Û†ÅßÛ†Å¢Û†Å∑Û†Å¨Û†Å≥Û†Åø', pl:'Walia', en:'Wales', others:['Cardiff','walie','bale']},
  {emoji:'üè¥Û†ÅßÛ†Å¢Û†Å≥Û†Å£Û†Å¥Û†Åø', pl:'Szkocja', en:'Scotland', others:['Edynburg','scottish','scot']},
  {emoji:'üáµüáº', pl:'Palau', en:'Palau', others:['Ngerulmud','palauan','palao']},
  {emoji:'üá¶üá∏', pl:'Samoa Ameryka≈Ñskie', en:'American Samoa', others:['Pago Pago','samoan','amercan samoa', 'samoa']},
  {emoji:'üáßüáÆ', pl:'Burundi', en:'Burundi', others:['Gitega','burundian','burndy']},
  {emoji:'üá¶üáΩ', pl:'Wyspy Alandzkie', en:'√Öland Islands', others:['Mariehamn','aland','aland islands', 'alandy']},
  {emoji:'üáßüáπ', pl:'Bhutan', en:'Bhutan', others:['Thimphu','bhutanese','butan']},
  {emoji:'üáßüáø', pl:'Belize', en:'Belize', others:['Belmopan','belizean','belizee', 'blaiz', 'blitz']},
  {emoji:'üá¨üáº', pl:'Gwinea Bissau', en:'Guinea-Bissau', others:['Bissau','bissauan','guinea bissao', 'gwinea']},
  {emoji:'üáÆüá≤', pl:'Wyspa Man', en:'Isle of Man', others:['Douglas','manx','isle man', 'man', 'spiderman']},
  {emoji:'üá≤üá≤', pl:'Mjanma', en:'Myanmar', others:['Naypyidaw','burmese','burma', 'mjanmar', 'myanma', 'mjanmarr']},
  {emoji:'üá≥üá®', pl:'Nowa Kaledonia', en:'New Caledonia', others:['Noum√©a','caledonian','noumea', 'kaledonia']},
  {emoji:'üáøüáº', pl:'Zimbabwe', en:'Zimbabwe', others:['Harare','zimbabwean','zimbabue']}
     ],
     hard:[
  {emoji:'üá¶üá®', pl:'Wyspa WniebowstƒÖpienia', en:'Ascension Island', others:['Georgetown','ascension','asencion', 'wniebowstopienie', 'niebo', 'uk']},
  {emoji:'üá¶üáÆ', pl:'Anguilla', en:'Anguilla', others:['The Valley','anguillan','anguila', 'uk']},
  {emoji:'üá¶üáº', pl:'Aruba', en:'Aruba', others:['Oranjestad','aruban','arubba']},
  {emoji:'üáßüá±', pl:'Saint-Barth√©lemy', en:'Saint Barth√©lemy', others:['Gustavia','barths','saint barthelemy', 'saint', 'bartek']},
  {emoji:'üáßüá≥', pl:'Brunei', en:'Brunei', others:['Bandar Seri Begawan','bruneian','bruney', 'bruno']},
  {emoji:'üáßüá∂', pl:'Bonaire, Sint Eustatius i Saba', en:'Bonaire, Sint Eustatius and Saba', others:['Kralendijk','bonaire','bonnaire', 'bono']},
  {emoji:'üá®üá∞', pl:'Wyspy Cooka', en:'Cook Islands', others:['Avarua','cook','cookislands', 'gotuj','uk']},
  {emoji:'üá©üá¨', pl:'Diego Garcia', en:'Diego Garcia', others:['diego','diago', 'garcia', 'uk']},
  {emoji:'üá™üá∑', pl:'Erytrea', en:'Eritrea', others:['Asmara','eritrean','eritra']},
  {emoji:'üá´üá∞', pl:'Falklandy', en:'Falkland Islands', others:['Stanley','falklander','falklands', 'uk']},
  {emoji:'üá´üá≤', pl:'Mikronezja', en:'Micronesia', others:['Palikir','micronesian','micronisia']},
  {emoji:'üá¨üá¨', pl:'Guernsey', en:'Guernsey', others:['Saint Peter Port','guernseyman','guernsy']},
  {emoji:'üá¨üá∏', pl:'Georgia Po≈Çudniowa i Sandwich Po≈Çudniowy', en:'South Georgia and the South Sandwich Islands', others:['King Edward Point','south georgia','sgssi', 'kanapka', 'georgia', 'sandwich', 'uk']},
  {emoji:'üá¨üá∫', pl:'Guam', en:'Guam', others:['Hag√•t√±a','guamanian','guuam']},
  {emoji:'üáÆüá¥', pl:'Brytyjskie Terytorium Oceanu Indyjskiego', en:'British Indian Ocean Territory', others:['Diego Garcia','british indian ocean','biot', 'brytania', 'uk']},
  {emoji:'üáØüá™', pl:'Jersey', en:'Jersey', others:['Saint Helier','jerseyman','jerzey']},
  {emoji:'üá∞üáÆ', pl:'Kiribati', en:'Kiribati', others:['Tarawa','kiribatian','kiribaty']},
  {emoji:'üá∞üáæ', pl:'Kajmany', en:'Cayman Islands', others:['George Town','caymanian','cayman', 'uk']},
  {emoji:'üá±üá®', pl:'Saint Lucia', en:'Saint Lucia', others:['Castries','lucian','st lucia', 'lucia', 'luis']},
  {emoji:'üá≤üáµ', pl:'Mariany P√≥≈Çnocne', en:'Northern Mariana Islands', others:['Saipan','northern marianas','cnmi', 'marian', 'mariany']},
  {emoji:'üá≥üá´', pl:'Norfolk', en:'Norfolk Island', others:['Kingston','norfolk islander','norfolc']},
  {emoji:'üá≥üá∑', pl:'Nauru', en:'Nauru', others:['Yaren','nauruan','nauru island']},
  {emoji:'üá≥üá∫', pl:'Niue', en:'Niue', others:['Alofi','niuean','niuue', 'uk']},
  {emoji:'üáµüá´', pl:'Polinezja Francuska', en:'French Polynesia', others:['Papeete','tahitian','polinesia', 'francja']},
  {emoji:'üáµüá≤', pl:'Saint-Pierre i Miquelon', en:'Saint Pierre and Miquelon', others:['Saint-Pierre','spm','miquelon', 'pierre', 'miquelon']},
  {emoji:'üáµüá≥', pl:'Pitcairn', en:'Pitcairn Islands', others:['Adamstown','pitcairner','pitcarn', 'uk']},
  {emoji:'üá∏üá≠', pl:'Wyspa ≈öwiƒôtej Heleny', en:'Saint Helena', others:['Jamestown','st helena','saint helena', 'wsh', 'helena', 'uk']},
  {emoji:'üá∏üáΩ', pl:'Sint Maarten', en:'Sint Maarten', others:['Philipsburg','dutch sint maarten','st maarten', 'maarten', 'martin']},
  {emoji:'üá∏üáø', pl:'Eswatini', en:'Eswatini', others:['Mbabane','swazi','swaziland']},
  {emoji:'üáπüá¶', pl:'Tristan da Cunha', en:'Tristan da Cunha', others:['Edinburgh of the Seven Seas','tristan','tda cunha', 'tdc', 'cunha', 'uk']},
  {emoji:'üáπüá®', pl:'Turks i Caicos', en:'Turks and Caicos Islands', others:['Cockburn Town','tc islands','turks caicos', 'tic', 'turks', 'uk']},
  {emoji:'üáπüá´', pl:'Francuskie Terytoria Po≈Çudniowe', en:'French Southern Territories', others:['Port-aux-Fran√ßais','ftd','french southern', 'francja']},
  {emoji:'üáπüá∞', pl:'Tokelau', en:'Tokelau', others:['Fakaofo','tokelauan','tokelou']},
  {emoji:'üáπüá±', pl:'Timor Wschodni', en:'Timor-Leste', others:['Dili','east timor','timorleste', 'timor']},
  {emoji:'üáπüáª', pl:'Tuvalu', en:'Tuvalu', others:['Funafuti','tuvaluan','tuvaloo', 'uk']},
  {emoji:'üáªüá¨', pl:'Brytyjskie Wyspy Dziewicze', en:'British Virgin Islands', others:['Road Town','bvi','british virgin', 'british', 'brytania', 'uk']},
  {emoji:'üáªüáÆ', pl:'Wyspy Dziewicze Stan√≥w Zjednoczonych', en:'United States Virgin Islands', others:['Charlotte Amalie','usvi','us virgin', 'usa']},
  {emoji:'üáªüá∫', pl:'Vanuatu', en:'Vanuatu', others:['Port Vila','ni-vanuatu','vanuatua']},
  {emoji:'üáºüá´', pl:'Wallis i Futuna', en:'Wallis and Futuna', others:['Mata-Utu','wallisian','futunan', 'wallis', 'fatuna', 'francja']},
  {emoji:'üáºüá∏', pl:'Samoa', en:'Samoa', others:['Apia','samoan','western samoa']},
  {emoji:'üáæüáπ', pl:'Majotta', en:'Mayotte', others:['Mamoudzou','mahoran','mayotta']}
     ]
    };

    // --- Helpery ---
    const $ = id => document.getElementById(id);
    const timeEl = document.querySelector('.time');
    const scoreEl = document.querySelector('.score');
    const emojiCard = $('emojiCard');
    const guessInput = $('guessInput');
    const revealText = $('revealText');
    const startBtn = $('startBtn');
    const overlay = $('overlay');
    const finalScore = $('finalScore');
    const bestScoreEl = $('bestScore');
    const restartBtn = $('restartBtn');
    const hintBtn = $('hintBtn');

    // Local storage key
    const RECORD_KEY = 'flagi';

    // Game state
    let dawid108 = localStorage.getItem("dawid108") || 0;
    let timeLeft = 60;
    let score = 0;
    let timerInterval = null;
    let gameActive = false;

    // Tier management
    let tiers = ['easy','medium','hard'];
    let pools = {}; // copies of arrays that we'll remove from as guessed
    let currentTierIndex = 0;
    let currentItem = null;
    let roundCount = 1; // first full pass is round 1; when we loop again becomes round 2 (bonus reduced)

    // ensure we have a mobile friendly keyboard suggestion
    guessInput.setAttribute('inputmode','text');

    function loadRecord(){
      return parseInt(localStorage.getItem(RECORD_KEY) || '0',10) || 0;
    }
    function saveRecord(val){ localStorage.setItem(RECORD_KEY, String(val)); }

    function shuffle(a){
      for(let i=a.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1)); [a[i],a[j]]=[a[j],a[i]]}
      return a;
    }

    function normalizeAnswer(s){
      if(!s) return '';
      // lowercase, trim, remove diacritics and punctuation
      const down = s.trim().toLowerCase();
      // remove diacritics
      return down.normalize('NFD').replace(/\p{Diacritic}/gu,'').replace(/[^a-z0-9\s]/g,'');
    }

    function preparePools(){
      pools = {};
      for(const t of tiers){
        // deep copy
        pools[t] = EMOJI_BANK[t].map(e=>Object.assign({}, e));
        shuffle(pools[t]);
      }
      currentTierIndex = 0;
    }

    function nextItem(){
      // if current tier pool empty -> move to next tier
      if(pools[tiers[currentTierIndex]].length === 0){
        currentTierIndex++;
        if(currentTierIndex >= tiers.length){
          // finished all tiers -> start new cycle
          currentTierIndex = 0;
          roundCount++;
          // prepare new pools again
          preparePools();
          // NOTE: according to spec: second loop onwards only +1s bonus
        }
      }
      // pop one
      const t = tiers[currentTierIndex];
      if(pools[t].length === 0) return null;
      currentItem = pools[t].pop();
      renderEmoji(currentItem.emoji);
      revealText.textContent = '';
    }

    function renderEmoji(e){
      emojiCard.textContent = e;
      // adjust font-size if emoji is wide
      emojiCard.classList.toggle('small', (''+e).length>2);
      // small scale animation
      emojiCard.style.transform='scale(1.02)';
      setTimeout(()=>emojiCard.style.transform='scale(1)',120);
    }

    function updateHUD(){
      timeEl.textContent = Math.max(0,Math.ceil(timeLeft)) + 's';
      scoreEl.textContent = String(score);
    }

    function endGame(){
      gameActive=false;
      clearInterval(timerInterval);
      guessInput.disabled = true;
      // show overlay with results
      finalScore.textContent = score;
      const best = loadRecord();
      if(score>best){ saveRecord(score); }
      bestScoreEl.textContent = loadRecord();
      overlay.classList.add('show');
      // hide keyboard
      guessInput.blur();
    }

    function tick(){
      timeLeft -= 0.25;
      if(timeLeft <= 0){ timeLeft = 0; updateHUD(); endGame(); return; }
      updateHUD();
    }

    function startGame(){
      // reset
      timeLeft = 60; score = 0; roundCount = 1; gameActive=true;
      preparePools();
      nextItem();
      updateHUD();
      guessInput.disabled = false;
      guessInput.value = '';
      guessInput.focus();
      overlay.classList.remove('show');
      clearInterval(timerInterval);
      timerInterval = setInterval(tick,250);
    }

    function checkAnswer(val){
      if(!gameActive) return;
      const answer = normalizeAnswer(val);
      if(!currentItem) return;
      const accepted = [currentItem.pl, currentItem.en].concat(currentItem.others||[])
        .filter(Boolean).map(normalizeAnswer);
      if(accepted.includes(answer)){
        score += 1;
        dawid108++;
        localStorage.setItem("dawid108", dawid108);
        console.log("dawid108:", dawid108);
        const bonus = (roundCount === 1) ? 4 : 1;
        timeLeft += bonus;
        updateHUD();
        guessInput.value = '';
        nextItem();
      } else {
        timeLeft -= 1; // zmiana z -5s na -1s
        if(timeLeft < 0) timeLeft = 0;
        revealText.textContent = `${currentItem.pl} / ${currentItem.en}`;
        updateHUD();
        guessInput.value = '';
        // poczekaj 2 sekundy przed nastƒôpnƒÖ emotkƒÖ
        setTimeout(()=>{
          nextItem();
          try{ guessInput.focus(); }catch(e){}
        },2000);
      }
      setTimeout(()=>{ try{ guessInput.focus(); }catch(e){} },60);
    }

    // --- events ---
    startBtn.addEventListener('click', ()=>{ startGame(); });
    restartBtn.addEventListener('click', ()=>{ startGame(); });

    guessInput.addEventListener('keydown', (e)=>{
      if(!gameActive) return;
      if(e.key === 'Enter'){
        e.preventDefault();
        const val = guessInput.value;
        checkAnswer(val);
      }
    });

    // also check on input blur/submit so mobile can use "go" key
    guessInput.addEventListener('input', (e)=>{
      // optional: if user types something and then presses a punctuation like space+enter we handle on enter
    });

    hintBtn.addEventListener('click', ()=>{
      if(!currentItem) return;
      // hint: show first letter of polish and english
      const pl = currentItem.pl ? currentItem.pl[0] : '?';
      const en = currentItem.en ? currentItem.en[0] : '?';
      revealText.textContent = `Podpowied≈∫: ${pl}... / ${en}...`;
      setTimeout(()=>{ try{ guessInput.focus(); }catch(e){} },50);
    });

    // Keep keyboard focused while game active on visibility change
    document.addEventListener('visibilitychange', ()=>{
      if(gameActive && !document.hidden){ setTimeout(()=>guessInput.focus(),80); }
    });

    // prevent typing when time over
    const observer = new MutationObserver(()=>{
      if(!gameActive){ guessInput.disabled = true; }
    });
    observer.observe(overlay,{attributes:true,childList:true,subtree:true});

    // init hud
    updateHUD();
    bestScoreEl.textContent = loadRecord();

    // Try to autofocus input when the page loads (may be blocked on some mobiles until user interacts)
    window.addEventListener('load', ()=>{ setTimeout(()=>{ try{ guessInput.focus(); }catch(e){} },300); });

    // Accessibility: allow spacebar to focus input if not focused
    window.addEventListener('keydown',(e)=>{
      if(e.code==='Space' && document.activeElement !== guessInput){ e.preventDefault(); guessInput.focus(); }
    });

    // On tap of emoji card also focus input
    emojiCard.addEventListener('click', ()=> guessInput.focus());

  </script>
</body>
</html>
